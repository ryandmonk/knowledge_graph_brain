kb_id: confluence-demo
embedding:
  provider: "ollama:mxbai-embed-large"
  chunking:
    strategy: "by_headings"
    max_tokens: 1200
schema:
  nodes:
    - label: Document
      key: page_id
      props: [page_id, title, url, space, created, content]
    - label: Person
      key: email
      props: [name, email]
    - label: Topic
      key: name
      props: [name]
  relationships:
    - type: AUTHORED_BY
      from: Document
      to: Person
    - type: DISCUSSES
      from: Document
      to: Topic
mappings:
  sources:
    - source_id: "confluence"
      connector_url: "http://localhost:3001/pull"
      document_type: "page"
      extract:
        node: Document
        assign:
          page_id: "$.id"
          title: "$.title"
          url: "$.url"
          space: "$.space"
          created: "$.created_date"
          content: "$.content"
      edges:
        - type: AUTHORED_BY
          from: { node: Document, key: "$.id" }
          to: 
            node: Person
            key: "$.author.email"
            props:
              name: "$.author.name"
              email: "$.author.email"
        - type: DISCUSSES
          from: { node: Document, key: "$.id" }
          to:
            node: Topic
            key: "$.labels[*]"
            props:
              name: "$.labels[*]"