kb_id: github-kb
embedding:
  provider: "ollama:mxbai-embed-large"
  chunking:
    strategy: "paragraph"
    max_tokens: 1000

schema:
  nodes:
    - label: Repository
      key: id
      props: [id, name, description, content, url, language, stars, forks, created_at, updated_at, topics, license, default_branch, is_private, is_fork]
    
    - label: Person
      key: login
      props: [login, name, email, type, url]

  relationships:
    - type: OWNED_BY
      from: Repository
      to: Person

mappings:
  sources:
    - source_id: github-repos
      connector_url: "http://localhost:3002/pull?owner=microsoft&data_types=repos"
      document_type: repository
      extract:
        node: Repository
        assign:
          id: "$.id"
          name: "$.title"
          description: "$.description"
          content: "$.content"
          url: "$.url"
          language: "$.language"
          stars: "$.stars"
          forks: "$.forks"
          created_at: "$.created_at"
          updated_at: "$.updated_at"
          topics: "$.topics"
          license: "$.license"
          default_branch: "$.default_branch"
          is_private: "$.is_private"
          is_fork: "$.is_fork"
      edges:
        - type: OWNED_BY
          from: { node: Repository, key: "$.id" }
          to:
            node: Person
            key: "$.owner.login"
            props:
              login: "$.owner.login"
              type: "$.owner.type"
              url: "$.owner.url"
